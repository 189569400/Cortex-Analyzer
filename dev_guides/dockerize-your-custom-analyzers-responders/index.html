
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.6">
    
    
      
        <title>dockerize-your-custom-analyzers-responders - Cortex Neurons documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a57b2b03.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/pdf.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dockerize-you-custom-analyzers-responders" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Cortex Neurons documentation" class="md-header__button md-logo" aria-label="Cortex Neurons documentation" data-md-component="logo">
      
  <img src="../../images/cortex-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cortex Neurons documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              dockerize-your-custom-analyzers-responders
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/TheHive-Project/Cortex-Analyzers/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Cortex-Neurons
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Cortex Neurons documentation" class="md-nav__button md-logo" aria-label="Cortex Neurons documentation" data-md-component="logo">
      
  <img src="../../images/cortex-logo.png" alt="logo">

    </a>
    Cortex Neurons documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/TheHive-Project/Cortex-Analyzers/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Cortex-Neurons
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Analyzers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Analyzers" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Analyzers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/AbuseIPDB/" class="md-nav__link">
        AbuseIPDB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Abuse_Finder/" class="md-nav__link">
        Abuse_Finder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/AnyRun/" class="md-nav__link">
        AnyRun
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Autofocus/" class="md-nav__link">
        Autofocus
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/BackscatterIO/" class="md-nav__link">
        BackscatterIO
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/C1fApp/" class="md-nav__link">
        C1fApp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/CERTatPassiveDNS/" class="md-nav__link">
        CERTatPassiveDNS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/CIRCLHashlookup/" class="md-nav__link">
        CIRCLHashlookup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/CIRCLPassiveDNS/" class="md-nav__link">
        CIRCLPassiveDNS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/CIRCLPassiveSSL/" class="md-nav__link">
        CIRCLPassiveSSL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Censys/" class="md-nav__link">
        Censys
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/ClamAV/" class="md-nav__link">
        ClamAV
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Crtsh/" class="md-nav__link">
        Crtsh
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/CuckooSandbox/" class="md-nav__link">
        CuckooSandbox
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/CyberChef/" class="md-nav__link">
        CyberChef
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/CyberCrime-Tracker/" class="md-nav__link">
        CyberCrime-Tracker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Cyberprotect/" class="md-nav__link">
        Cyberprotect
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/DNSDB/" class="md-nav__link">
        DNSDB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/DNSLookingglass/" class="md-nav__link">
        DNSLookingglass
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/DNSSinkhole/" class="md-nav__link">
        DNSSinkhole
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/DShield/" class="md-nav__link">
        DShield
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Diario/" class="md-nav__link">
        Diario
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/DomainMailSPFDMARC/" class="md-nav__link">
        DomainMailSPFDMARC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/DomainTools/" class="md-nav__link">
        DomainTools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/DomainToolsIris/" class="md-nav__link">
        DomainToolsIris
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Elasticsearch/" class="md-nav__link">
        Elasticsearch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/EmailRep/" class="md-nav__link">
        EmailRep
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/EmergingThreats/" class="md-nav__link">
        EmergingThreats
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/EmlParser/" class="md-nav__link">
        EmlParser
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/FileInfo/" class="md-nav__link">
        FileInfo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/FireEyeiSight/" class="md-nav__link">
        FireEyeiSight
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/FireHOLBlocklists/" class="md-nav__link">
        FireHOLBlocklists
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/ForcepointWebsensePing/" class="md-nav__link">
        ForcepointWebsensePing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Fortiguard/" class="md-nav__link">
        Fortiguard
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/GRR/" class="md-nav__link">
        GRR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/GoogleDNS/" class="md-nav__link">
        GoogleDNS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/GoogleSafebrowsing/" class="md-nav__link">
        GoogleSafebrowsing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/GoogleVisionAPI/" class="md-nav__link">
        GoogleVisionAPI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/GreyNoise/" class="md-nav__link">
        GreyNoise
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/HIBP/" class="md-nav__link">
        HIBP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Hashdd/" class="md-nav__link">
        Hashdd
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Hippocampe/" class="md-nav__link">
        Hippocampe
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Hunterio/" class="md-nav__link">
        Hunterio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/HybridAnalysis/" class="md-nav__link">
        HybridAnalysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/IBMXForce/" class="md-nav__link">
        IBMXForce
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/IPVoid/" class="md-nav__link">
        IPVoid
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/IPinfo/" class="md-nav__link">
        IPinfo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/IVRE/" class="md-nav__link">
        IVRE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Inoitsu/" class="md-nav__link">
        Inoitsu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/IntezerCommunity/" class="md-nav__link">
        IntezerCommunity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Investigate/" class="md-nav__link">
        Investigate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/JoeSandbox/" class="md-nav__link">
        JoeSandbox
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/LastInfoSec/" class="md-nav__link">
        LastInfoSec
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/LdapQuery/" class="md-nav__link">
        LdapQuery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/MISP/" class="md-nav__link">
        MISP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/MISPWarningLists/" class="md-nav__link">
        MISPWarningLists
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Malpedia/" class="md-nav__link">
        Malpedia
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Maltiverse/" class="md-nav__link">
        Maltiverse
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/MalwareBazaar/" class="md-nav__link">
        MalwareBazaar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/MalwareClustering/" class="md-nav__link">
        MalwareClustering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Malwares/" class="md-nav__link">
        Malwares
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/MaxMind/" class="md-nav__link">
        MaxMind
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/MetaDefender/" class="md-nav__link">
        MetaDefender
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/MnemonicPDNS/" class="md-nav__link">
        MnemonicPDNS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/MsgParser/" class="md-nav__link">
        MsgParser
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/NERD/" class="md-nav__link">
        NERD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/NSRL/" class="md-nav__link">
        NSRL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Nessus/" class="md-nav__link">
        Nessus
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/OTXQuery/" class="md-nav__link">
        OTXQuery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Onyphe/" class="md-nav__link">
        Onyphe
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/OpenCTI/" class="md-nav__link">
        OpenCTI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/PassiveTotal/" class="md-nav__link">
        PassiveTotal
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Patrowl/" class="md-nav__link">
        Patrowl
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/PayloadSecurity/" class="md-nav__link">
        PayloadSecurity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/PhishTank/" class="md-nav__link">
        PhishTank
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/PhishingInitiative/" class="md-nav__link">
        PhishingInitiative
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/ProofPoint/" class="md-nav__link">
        ProofPoint
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Pulsedive/" class="md-nav__link">
        Pulsedive
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/RecordedFuture/" class="md-nav__link">
        RecordedFuture
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Robtex/" class="md-nav__link">
        Robtex
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/SEKOIAIntelligenceCenter/" class="md-nav__link">
        SEKOIAIntelligenceCenter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/SecurityTrails/" class="md-nav__link">
        SecurityTrails
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Shodan/" class="md-nav__link">
        Shodan
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/SinkDB/" class="md-nav__link">
        SinkDB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/SoltraEdge/" class="md-nav__link">
        SoltraEdge
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/SophosIntelix/" class="md-nav__link">
        SophosIntelix
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/SpamAssassin/" class="md-nav__link">
        SpamAssassin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/SpamhausDBL/" class="md-nav__link">
        SpamhausDBL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Splunk/" class="md-nav__link">
        Splunk
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/StamusNetworks/" class="md-nav__link">
        StamusNetworks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/StaxxSearch/" class="md-nav__link">
        StaxxSearch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/StopForumSpam/" class="md-nav__link">
        StopForumSpam
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/TalosReputation/" class="md-nav__link">
        TalosReputation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/TeamCymruMHR/" class="md-nav__link">
        TeamCymruMHR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/ThreatGrid/" class="md-nav__link">
        ThreatGrid
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/ThreatResponse/" class="md-nav__link">
        ThreatResponse
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Threatcrowd/" class="md-nav__link">
        Threatcrowd
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Thunderstorm/" class="md-nav__link">
        Thunderstorm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/TorBlutmagie/" class="md-nav__link">
        TorBlutmagie
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/TorProject/" class="md-nav__link">
        TorProject
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Triage/" class="md-nav__link">
        Triage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/URLhaus/" class="md-nav__link">
        URLhaus
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Umbrella/" class="md-nav__link">
        Umbrella
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/UnshortenLink/" class="md-nav__link">
        UnshortenLink
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Urlscan.io/" class="md-nav__link">
        Urlscan
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/VMRay/" class="md-nav__link">
        VMRay
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Valhalla/" class="md-nav__link">
        Valhalla
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/VirusTotal/" class="md-nav__link">
        VirusTotal
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Virusshare/" class="md-nav__link">
        Virusshare
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Vulners/" class="md-nav__link">
        Vulners
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/WOT/" class="md-nav__link">
        WOT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Yara/" class="md-nav__link">
        Yara
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/Yeti/" class="md-nav__link">
        Yeti
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Responders
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Responders" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Responders
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/AMPforEndpoints/" class="md-nav__link">
        AMPforEndpoints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/AzureTokenRevoker/" class="md-nav__link">
        AzureTokenRevoker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/CheckPoint/" class="md-nav__link">
        CheckPoint
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/DNS-RPZ/" class="md-nav__link">
        DNS-RPZ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/DomainToolsIris_AddRiskyDNSTag/" class="md-nav__link">
        DomainToolsIris_AddRiskyDNSTag
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/DomainToolsIris_CheckMaliciousTags/" class="md-nav__link">
        DomainToolsIris_CheckMaliciousTags
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/Duo_Security/" class="md-nav__link">
        Duo_Security
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/FalconCustomIOC/" class="md-nav__link">
        FalconCustomIOC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/Gmail/" class="md-nav__link">
        Gmail
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/KnowBe4/" class="md-nav__link">
        KnowBe4
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/MailIncidentStatus/" class="md-nav__link">
        MailIncidentStatus
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/Mailer/" class="md-nav__link">
        Mailer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/Minemeld/" class="md-nav__link">
        Minemeld
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/PaloAltoNGFW/" class="md-nav__link">
        PaloAltoNGFW
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/QRadarAutoClose/" class="md-nav__link">
        QRadarAutoClose
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/RT4/" class="md-nav__link">
        RT4
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/Redmine/" class="md-nav__link">
        Redmine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/SendGrid/" class="md-nav__link">
        SendGrid
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/Shuffle/" class="md-nav__link">
        Shuffle
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/UmbrellaBlacklister/" class="md-nav__link">
        UmbrellaBlacklister
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/Velociraptor/" class="md-nav__link">
        Velociraptor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/VirustotalDownloader/" class="md-nav__link">
        VirustotalDownloader
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/Wazuh/" class="md-nav__link">
        Wazuh
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/ZEROFOX_Close_alert/" class="md-nav__link">
        ZEROFOX_Close_alert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../responders/ZEROFOX_Takedown_request/" class="md-nav__link">
        ZEROFOX_Takedown_request
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Developers guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Developers guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Developers guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../analyzers_definition/" class="md-nav__link">
        analyzers_definition
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          dockerize-your-custom-analyzers-responders
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        dockerize-your-custom-analyzers-responders
      </a>
      
        


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cortex-analyzers-catalogs" class="md-nav__link">
    Cortex-Analyzers catalogs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-if-you-use-custom-and-private-analyzers-and-responders" class="md-nav__link">
    What if you use custom and private Analyzers and Responders ?
  </a>
  
    <nav class="md-nav" aria-label="What if you use custom and private Analyzers and Responders ?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build-your-images" class="md-nav__link">
    Build your images
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-your-catalog" class="md-nav__link">
    Build your catalog
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register-your-catalogs-in-cortex-configuration" class="md-nav__link">
    Register your catalogs in Cortex configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buildsh" class="md-nav__link">
    build.sh
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-create-an-analyzer/" class="md-nav__link">
        how-to-create-an-analyzer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-test-an-analyzer/" class="md-nav__link">
        how-to-test-an-analyzer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../CHANGELOG/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../code_of_conduct/" class="md-nav__link">
        Code of Conduct
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cortex-analyzers-catalogs" class="md-nav__link">
    Cortex-Analyzers catalogs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-if-you-use-custom-and-private-analyzers-and-responders" class="md-nav__link">
    What if you use custom and private Analyzers and Responders ?
  </a>
  
    <nav class="md-nav" aria-label="What if you use custom and private Analyzers and Responders ?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build-your-images" class="md-nav__link">
    Build your images
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-your-catalog" class="md-nav__link">
    Build your catalog
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register-your-catalogs-in-cortex-configuration" class="md-nav__link">
    Register your catalogs in Cortex configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buildsh" class="md-nav__link">
    build.sh
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/TheHive-Project/Cortex-Analyzers/edit/master/docs/dev_guides/dockerize-your-custom-analyzers-responders.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="dockerize-you-custom-analyzers-responders">Dockerize you custom Analyzers &amp; Responders<a class="headerlink" href="#dockerize-you-custom-analyzers-responders" title="Permanent link">#</a></h1>
<h2 id="cortex-analyzers-catalogs">Cortex-Analyzers catalogs<a class="headerlink" href="#cortex-analyzers-catalogs" title="Permanent link">#</a></h2>
<p>Since Cortex version 3.0, Analyzers and Responders can be executed as docker containers, and this is useful in several ways. The first is you do not have to bother with libraries and dependancies to run the program ; download the image, run it, trash it.<br />
We provide up-to-date docker images for all programs publicly available on our repository (https://github.com/TheHive-Project/Cortex-Analyzers). To use them, you just need to specify the catalog in the <code>application.conf</code> file for Cortex: </p>
<div class="highlight"><pre><span></span><code><span class="err">a</span><span class="kc">nal</span><span class="err">yzer</span> <span class="p">{</span>
  <span class="err">urls</span> <span class="err">=</span> <span class="p">[</span>
         <span class="s2">&quot;https://download.thehive-project.org/analyzers.json&quot;</span>
        <span class="p">]</span>
</code></pre></div>
<h2 id="what-if-you-use-custom-and-private-analyzers-and-responders">What if you use custom and private Analyzers and Responders ?<a class="headerlink" href="#what-if-you-use-custom-and-private-analyzers-and-responders" title="Permanent link">#</a></h2>
<p>If you are using you own programs and want them to be processed as docker container, you can. You need to: 
- Build your images
- Build your catalog
- Register you catalog in Cortex</p>
<h3 id="build-your-images">Build your images<a class="headerlink" href="#build-your-images" title="Permanent link">#</a></h3>
<p>You need to build your docker image for each Analyzer/Responder. Ours are built with this <em>Dockerfile</em>  template except if a <em>Dockerfile</em> is present in the folder: </p>
<div class="highlight"><pre><span></span><code><span class="k">FROM</span> <span class="s">python:3</span>
<span class="k">WORKDIR</span><span class="s"> /worker</span>
<span class="k">COPY</span> . <span class="o">{</span>worker_name<span class="o">}</span>
<span class="k">RUN</span> <span class="nb">test</span> ! -e <span class="o">{</span>worker_name<span class="o">}</span>/requirements.txt <span class="o">||</span> pip install --no-cache-dir -r<span class="o">{</span>worker_name<span class="o">}</span>/requirements.txt
<span class="k">ENTRYPOINT</span> <span class="o">{</span>command<span class="o">}</span>
</code></pre></div>
<p><em>update variables accordingly</em></p>
<p>This file is also in the repository: <a href="https://github.com/TheHive-Project/Cortex-Analyzers/blob/master/utils/docker/Dockerfile_template">Cortex-Analyzers/Dockerfile_template at master · TheHive-Project/Cortex-Analyzers · GitHub</a></p>
<h3 id="build-your-catalog">Build your catalog<a class="headerlink" href="#build-your-catalog" title="Permanent link">#</a></h3>
<p>A catalog is required for Analyzers and Responders. A catalog is a list of flavor definitions (typically the json definition of the flavor) and for each of them the <em>dockerImage</em> attribute is added with the name of the associated image. 
This catalog, when registered in Cortex's configuration file, allows the discovery of the available Analyzers or Responders and tells Cortex how to run each worker using the dockerImage attribute. Below is an example of a catalog file that contains a single Analyzer:</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span>
<span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;DShield_lookup&quot;</span><span class="p">,</span>
  <span class="nt">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
  <span class="nt">&quot;author&quot;</span><span class="p">:</span> <span class="s2">&quot;Xavier Xavier, SANS ISC&quot;</span><span class="p">,</span>
  <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://github.com/xme/thehive/Cortex-Analyzers&quot;</span><span class="p">,</span>
  <span class="nt">&quot;license&quot;</span><span class="p">:</span> <span class="s2">&quot;AGPL-V3&quot;</span><span class="p">,</span>
  <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Query the SANS ISC DShield API to check for an IP address reputation.&quot;</span><span class="p">,</span>
  <span class="nt">&quot;dataTypeList&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&quot;ip&quot;</span>
  <span class="p">],</span>
  <span class="nt">&quot;baseConfig&quot;</span><span class="p">:</span> <span class="s2">&quot;DShield&quot;</span><span class="p">,</span>
  <span class="nt">&quot;config&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;service&quot;</span><span class="p">:</span> <span class="s2">&quot;query&quot;</span>
  <span class="p">},</span>
  <span class="nt">&quot;registration_required&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="nt">&quot;subscription_required&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="nt">&quot;free_subscription&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nt">&quot;service_homepage&quot;</span><span class="p">:</span> <span class="s2">&quot;https://isc.sans.edu/&quot;</span><span class="p">,</span>
  <span class="nt">&quot;service_logo&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;assets/dshield.png&quot;</span><span class="p">,</span>
    <span class="nt">&quot;caption&quot;</span><span class="p">:</span> <span class="s2">&quot;logo&quot;</span>
  <span class="p">},</span>
  <span class="nt">&quot;screenshots&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;assets/long_report.png&quot;</span><span class="p">,</span>
      <span class="nt">&quot;caption&quot;</span><span class="p">:</span> <span class="s2">&quot;DShield: long report&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">&quot;dockerImage&quot;</span><span class="p">:</span> <span class="s2">&quot;cortexneurons/dshield_lookup:1.0&quot;</span>
<span class="p">}</span>
<span class="p">]</span>
</code></pre></div>
<h3 id="register-your-catalogs-in-cortex-configuration">Register your catalogs in Cortex configuration<a class="headerlink" href="#register-your-catalogs-in-cortex-configuration" title="Permanent link">#</a></h3>
<p>Update your Cortex configuration file (<code>/etc/cortex/application.conf</code>) with your own catalog; e.g. for <em>Analyzers</em>:  </p>
<div class="highlight"><pre><span></span><code>analyzer {
  urls = [
         &quot;https://download.thehive-project.org/analyzers.json&quot;
         &quot;/opt/Custom-Analyzers/analyzers/analyzers.json&quot;
        ]
</code></pre></div>
<p>Then restart Cortex.</p>
<h3 id="buildsh">build.sh<a class="headerlink" href="#buildsh" title="Permanent link">#</a></h3>
<p>This program allows you to build your own images  ~AND~ catalogs. This program assumes your folder of custom <em>Analyzers</em> and <em>Responders</em> are respectively stored in <em>analyzers</em> and <em>responders</em> folders.</p>
<div class="highlight"><pre><span></span><code>Custom-Analyzers
├── analyzers/
│   └── My_custom_analyzer/
└── responders/
    └── My_custom_responder/
        ├── customresponderflavor.json
        ├── Dockerfile
        ├── program.py*
        ├── README.md
        └── requirements.txt
</code></pre></div>
<p>To use it, update the variable <code>DOCKER_REPOSITORY</code> first (for example with the name of your team). Enter the folder of your own programs, amd and run it.</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> ./Custom-Analyzers
bash /path/to/build.sh 
</code></pre></div>
<p>Once finished, you should find your docker images built, and catalogs as well in <code>./analyzers/analyzers.json</code> and  <code>./responders/responders.json</code>.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>

<span class="c1">###</span>
<span class="c1"># This program assumes your analyzers and responders folder looks like: </span>
<span class="c1">#</span>
<span class="c1">#     Custom-Analyzers</span>
<span class="c1">#     ├── analyzers/</span>
<span class="c1">#     │   └── My_custom_analyzer/</span>
<span class="c1">#     └── responders/</span>
<span class="c1">#         └── My_custom_responder/</span>
<span class="c1">#             ├── customresponderflavor.json</span>
<span class="c1">#             ├── Dockerfile</span>
<span class="c1">#             ├── program.py*</span>
<span class="c1">#             ├── README.md</span>
<span class="c1">#             └── requirements.txt</span>
<span class="c1">#</span>
<span class="c1"># Usage: </span>
<span class="c1"># Update DOCKER_REPOSITORY variable</span>
<span class="c1"># cd ./Custom-Analyzers</span>
<span class="c1"># bash /path/to/build.sh </span>
<span class="c1">###</span>

<span class="c1"># Set your docker repository name</span>
<span class="nv">DOCKER_REPOSITORY</span><span class="o">=</span>ilovestrangebee

build_image<span class="o">()</span> <span class="o">{</span>
      <span class="nv">JSON</span><span class="o">=</span><span class="nv">$1</span>
    cat <span class="s">&lt;&lt; EOF &gt; /tmp/default_dockerfile</span>
<span class="s">FROM python:3</span>
<span class="s">WORKDIR /worker</span>
<span class="s">ARG workername</span>
<span class="s">ARG command</span>
<span class="s">COPY . \$workername</span>
<span class="s">RUN test ! -e \$workername/requirements.txt || pip install --no-cache-dir -r \$workername/requirements.txt</span>
<span class="s">ENTRYPOINT \$command</span>
<span class="s">EOF</span>

    <span class="nv">DEFAULT_DOCKERFILE</span><span class="o">=</span>/tmp/default_dockerfile
      <span class="nv">TAG</span><span class="o">=</span><span class="sb">`</span>cat <span class="si">${</span><span class="nv">JSON</span><span class="si">}</span> <span class="p">|</span> jq -r <span class="s1">&#39;( &quot;&#39;</span><span class="s2">&quot;</span><span class="nv">$DOCKER_REPOSITORY</span><span class="s2">&quot;</span><span class="s1">&#39;&quot; + &quot;/&quot; + (.name | ascii_downcase) + &quot;:&quot; + (.version))&#39;</span><span class="sb">`</span>
    <span class="nv">WORKER_NAME</span><span class="o">=</span><span class="sb">`</span>cat <span class="si">${</span><span class="nv">JSON</span><span class="si">}</span> <span class="p">|</span> jq -r <span class="s1">&#39;(.version)&#39;</span><span class="sb">`</span>  
    <span class="nv">COMMAND</span><span class="o">=</span><span class="sb">`</span>cat <span class="si">${</span><span class="nv">JSON</span><span class="si">}</span> <span class="p">|</span> jq -r <span class="s1">&#39;(.command)&#39;</span><span class="sb">`</span>
    <span class="nv">DIRNAME</span><span class="o">=</span><span class="sb">`</span>dirname <span class="si">${</span><span class="nv">JSON</span><span class="si">}</span><span class="sb">`</span>
      <span class="nv">WORKER_NAME</span><span class="o">=</span><span class="sb">`</span>basename <span class="si">${</span><span class="nv">DIRNAME</span><span class="si">}</span><span class="sb">`</span>
    <span class="k">if</span> <span class="nb">test</span> -f <span class="si">${</span><span class="nv">DIRNAME</span><span class="si">}</span>/Dockerfile
    <span class="k">then</span>
          docker build -t <span class="si">${</span><span class="nv">TAG</span><span class="si">}</span> <span class="sb">`</span>dirname <span class="si">${</span><span class="nv">JSON</span><span class="si">}</span><span class="sb">`</span>
    <span class="k">else</span>
          docker build --build-arg <span class="nv">workername</span><span class="o">=</span><span class="si">${</span><span class="nv">WORKER_NAME</span><span class="si">}</span> --build-arg <span class="nv">command</span><span class="o">=</span><span class="si">${</span><span class="nv">COMMAND</span><span class="si">}</span> -f <span class="si">${</span><span class="nv">DEFAULT_DOCKERFILE</span><span class="si">}</span> -t <span class="si">${</span><span class="nv">TAG</span><span class="si">}</span> <span class="sb">`</span>dirname <span class="si">${</span><span class="nv">JSON</span><span class="si">}</span><span class="sb">`</span>
    <span class="k">fi</span>
<span class="o">}</span>

build_catalog<span class="o">()</span> <span class="o">{</span>
    <span class="nv">DIR</span><span class="o">=</span><span class="nv">$1</span>
    <span class="nb">echo</span> <span class="s1">&#39;[&#39;</span> &gt; <span class="si">${</span><span class="nv">DIR</span><span class="si">}</span>/<span class="si">${</span><span class="nv">DIR</span><span class="si">}</span>.json


    <span class="nv">first</span><span class="o">=</span><span class="m">1</span>
    <span class="k">for</span> JSON <span class="k">in</span> <span class="si">${</span><span class="nv">DIR</span><span class="si">}</span>/*/*.json
    <span class="k">do</span>
          build_image <span class="si">${</span><span class="nv">JSON</span><span class="si">}</span> 
        <span class="k">if</span> <span class="nb">test</span> -z <span class="s2">&quot;</span><span class="si">${</span><span class="nv">first</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">then</span>
              <span class="nb">echo</span> <span class="s1">&#39;,&#39;</span> &gt;&gt; <span class="si">${</span><span class="nv">DIR</span><span class="si">}</span>/<span class="si">${</span><span class="nv">DIR</span><span class="si">}</span>.json
        <span class="k">else</span>
              <span class="nv">first</span><span class="o">=</span>
        <span class="k">fi</span>  
        jq <span class="s1">&#39;del(.command) + { dockerImage: (&quot;&#39;</span><span class="s2">&quot;</span><span class="nv">$DOCKER_REPOSITORY</span><span class="s2">&quot;</span><span class="s1">&#39;&quot; + &quot;/&quot; + (.name | ascii_downcase) + &quot;:&quot; + (.version)) }&#39;</span> <span class="si">${</span><span class="nv">JSON</span><span class="si">}</span> &gt;&gt; <span class="si">${</span><span class="nv">DIR</span><span class="si">}</span>/<span class="si">${</span><span class="nv">DIR</span><span class="si">}</span>.json
    <span class="k">done</span>

    <span class="nb">echo</span> <span class="s1">&#39;]&#39;</span> &gt;&gt; <span class="si">${</span><span class="nv">DIR</span><span class="si">}</span>/<span class="si">${</span><span class="nv">DIR</span><span class="si">}</span>.json
<span class="o">}</span>

build_catalog analyzers
build_catalog responders
</code></pre></div>
                
                  
                    

<hr>
<div class="md-source-date">
  <small>
    
      Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">November 15, 2021 06:16:20</span>
      
    
  </small>
</div>
                  
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../analyzers_definition/" class="md-footer__link md-footer__link--prev" aria-label="Previous: analyzers_definition" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              analyzers_definition
            </div>
          </div>
        </a>
      
      
        
        <a href="../how-to-create-an-analyzer/" class="md-footer__link md-footer__link--next" aria-label="Next: how-to-create-an-analyzer" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              how-to-create-an-analyzer
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://www.thehive-project.org" target="_blank" rel="noopener" title="www.thehive-project.org" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M280.37 148.26 96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47 488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://blog.thehive-project.org" target="_blank" rel="noopener" title="blog.thehive-project.org" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="m61.7 169.4 101.5 278C92.2 413 43.3 340.2 43.3 256c0-30.9 6.6-60.1 18.4-86.6zm337.9 75.9c0-26.3-9.4-44.5-17.5-58.7-10.8-17.5-20.9-32.4-20.9-49.9 0-19.6 14.8-37.8 35.7-37.8.9 0 1.8.1 2.8.2-37.9-34.7-88.3-55.9-143.7-55.9-74.3 0-139.7 38.1-177.8 95.9 5 .2 9.7.3 13.7.3 22.2 0 56.7-2.7 56.7-2.7 11.5-.7 12.8 16.2 1.4 17.5 0 0-11.5 1.3-24.3 2l77.5 230.4L249.8 247l-33.1-90.8c-11.5-.7-22.3-2-22.3-2-11.5-.7-10.1-18.2 1.3-17.5 0 0 35.1 2.7 56 2.7 22.2 0 56.7-2.7 56.7-2.7 11.5-.7 12.8 16.2 1.4 17.5 0 0-11.5 1.3-24.3 2l76.9 228.7 21.2-70.9c9-29.4 16-50.5 16-68.7zm-139.9 29.3-63.8 185.5c19.1 5.6 39.2 8.7 60.1 8.7 24.8 0 48.5-4.3 70.6-12.1-.6-.9-1.1-1.9-1.5-2.9l-65.4-179.2zm183-120.7c.9 6.8 1.4 14 1.4 21.9 0 21.6-4 45.8-16.2 76.2l-65 187.9C426.2 403 468.7 334.5 468.7 256c0-37-9.4-71.8-26-102.1zM504 256c0 136.8-111.3 248-248 248C119.2 504 8 392.7 8 256 8 119.2 119.2 8 256 8c136.7 0 248 111.2 248 248zm-11.4 0c0-130.5-106.2-236.6-236.6-236.6C125.5 19.4 19.4 125.5 19.4 256S125.6 492.6 256 492.6c130.5 0 236.6-106.1 236.6-236.6z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/TheHive_Project" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://github.com/TheHive-Project" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://gitter.im/TheHive-Project/TheHive" target="_blank" rel="noopener" title="gitter.im" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M66.4 322.5H16V0h50.4v322.5zM166.9 76.1h-50.4V512h50.4V76.1zm100.6 0h-50.4V512h50.4V76.1zM368 76h-50.4v247H368V76z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.fcfe8b6d.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.b1047164.min.js"></script>
      
    
  </body>
</html>